<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="ac.ict.menelaus.aiops.dal.impl.IPSDal">
	<resultMap id="IPSMap" type="IPS">
	  <id property="Id" column="id" />
	  <result property="Timestamp" column="timestampe"/>
	  <result property="RuleName" column="rule_name"/>
	  <result property="VulnerabilityId" column="vulnerability_id"/>
	  <result property="VulerabilityName" column="vulnerability_name"/>
	  <result property="SourceIp" column="source_ip"/>
	  <result property="SourcePort" column="source_port"/>
	  <result property="DestinationIp" column="destination_ip"/>
	  <result property="DestinationPort" column="destination_port"/>
	  <result property="Protocol" column="protocol"/>
	  <result property="AttackType" column="attack_type"/>
	  <result property="Severity" column="severity"/>
	  <result property="SystemAction" column="system_action"/>
	</resultMap>
	
	<select id="SelectByPage" resultMap="IPSMap" parameterType="java.util.Map">
		select * from IPS where
		<if test="Id != null">
			id = #{Id,jdbcType=INTEGER} and
		</if>
		<if test="Timestamp != null">
			timestamp = #{Timestamp,jdbcType=DATE} and
		</if>
		<if test="RuleName != null">
			rule_name = #{RuleName,jdbcType=VARCHAR} and
		</if>
		<if test="VulnerabilityId != null">
			vulnerability_id = #{VulnerabilityId,jdbcType=INTEGER} and
		</if>
		<if test="VulerabilityName != null">
			vulnerability_name = #{VulerabilityName,jdbcType=VARCHAR} and
		</if>
		<if test="SourceIp != null">
			source_ip = #{SourceIp,jdbcType=VARCHAR} and
		</if>
		<if test="SourcePort != null">
			source_port = #{SourcePort,jdbcType=INTEGER} and
		</if>
		<if test="DestinationIp != null">
			destination_ip = #{DestinationIp,jdbcType=VARCHAR} and
		</if>
		<if test="DestinationPort != null">
			destination_port = #{DestinationPort,jdbcType=INTEGER} and
		</if>
		<if test="Protocol != null">
			protocol = #{Protocol,jdbcType=VARCHAR} and
		</if>
		<if test="AttackType != null">
			attack_type = #{AttackType,jdbcType=VARCHAR} and
		</if>
		<if test="Severity != null">
			severity = #{Severity,jdbcType=VARCHAR} and
		</if>
		<if test="SystemAction != null">
			system_action = #{SystemAction,jdbcType=VARCHAR} and
		</if>
		 1=1 LIMIT #{Offset},#{Count};
	</select>

</mapper>